{"version":3,"file":"static/js/417.49163451.chunk.js","mappings":"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","sources":["components/PageTitle.js","pages/Bookings.jsx"],"sourcesContent":["import React from \"react\";\n\nfunction PageTitle({ title }) {\n  return (\n    <div>\n      <h1 className=\"text-xl\">{title}</h1>\n    </div>\n  );\n}\n\nexport default PageTitle;\n","import React, { useEffect, useState, useCallback } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { message, Table } from \"antd\";\nimport { HideLoading, ShowLoading } from \"../redux/alertsSlice\";\nimport PageTitle from \"../components/PageTitle\";\nimport moment from \"moment\";\nimport { Helmet } from \"react-helmet\";\n\nfunction Bookings() {\n  const [bookings, setBookings] = useState([]);\n  const dispatch = useDispatch();\n\n  const getBookings = useCallback(async () => {\n    try {\n      dispatch(ShowLoading());\n      const response = await axios.get(`/api/bookings/${localStorage.getItem(\"user_id\")}`,{\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        }\n      });\n      dispatch(HideLoading());\n      if (response.data.success) {\n        const mappedData = response.data.data.map((booking) => {\n          return {\n            ...booking,\n            ...booking.bus,\n            key: booking._id,\n            user: booking.user.name,\n          };\n        });\n        setBookings(mappedData);\n      } else {\n        message.error(response.data.message);\n      }\n    } catch (error) {\n      dispatch(HideLoading());\n      message.error(error.message);\n    }\n  }, [dispatch]);\n\n  const CancelBooking = async () => {\n    try {\n      dispatch(ShowLoading());\n      const res = await axios.get(\n        `/api/bookings/${localStorage.getItem(\"user_id\")}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          }\n        });\n      const bus_id = res.data.data[0].bus._id;\n      const user_id = res.data.data[0].user._id;\n      const booking_id = res.data.data[0]._id;\n      const response = await axios.delete(`/api/bookings/${booking_id}/${user_id}/${bus_id}`,{\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        }\n      });\n      dispatch(HideLoading());\n      if (response.data.success) {\n        message.success(response.data.message);\n        getBookings();\n      } else {\n        message.error(response.data.message);\n      }\n    } catch (error) {\n      dispatch(HideLoading());\n      message.error(error.message);\n    }\n  };\n\n  const columns = [\n    {\n      title: \"Bus Name\",\n      dataIndex: \"name\",\n      key: \"bus\",\n    },\n    {\n      title: \"Full Name\",\n      dataIndex: \"user\",\n      key: \"user\",\n    },\n\n    {\n      title: \"Bus Number\",\n      dataIndex: \"busNumber\",\n      key: \"bus\",\n    },\n    {\n      title: \"Journey Date\",\n      dataIndex: \"journeyDate\",\n      render: (journeyDate) => moment(journeyDate).format(\"DD/MM/YYYY\"),\n    },\n    {\n      title: \"Journey Time\",\n      dataIndex: \"departure\",\n      render: (departure) => moment(departure, \"HH:mm\").format(\"hh:mm A\"),\n    },\n    {\n      title: \"Seats\",\n      dataIndex: \"seats\",\n      render: (seats) => seats.join(\", \"),\n    },\n    {\n      title: \"Action\",\n      dataIndex: \"action\",\n      render: (text, record) => (\n        <div className=\"flex gap-2\">\n          <button\n            className=\"underline text-base text-red-500 cursor-pointer hover:text-red-700\"\n            onClick={() => {\n              CancelBooking();\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      ),\n    },\n  ];\n\n  useEffect(() => {\n    getBookings();\n  }, [getBookings]);\n\n  return (\n    <>\n      <Helmet>\n        <title>Bookings</title>\n      </Helmet>\n\n      <div className=\"p-5\">\n        <PageTitle title=\"Bookings\" />\n        <Table columns={columns} dataSource={bookings} />\n      </div>\n    </>\n  );\n}\n\nexport default Bookings;\n"],"names":["title","className","useState","bookings","setBookings","dispatch","useDispatch","getBookings","useCallback","ShowLoading","axios","localStorage","getItem","headers","Authorization","response","HideLoading","data","success","mappedData","map","booking","bus","key","_id","user","name","message","CancelBooking","res","bus_id","user_id","booking_id","columns","dataIndex","render","journeyDate","moment","format","departure","seats","join","text","record","onClick","useEffect","dataSource"],"sourceRoot":""}